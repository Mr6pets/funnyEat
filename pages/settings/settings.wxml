<!--pages/settings/settings.wxml-->
<view class="settings-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">{{t('settings.title')}}</text>
    <text class="page-subtitle">{{t('settings.preferences')}}</text>
  </view>

  <!-- è¯­è¨€è®¾ç½® -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">{{t('settings.language')}}</text>
      <text class="section-subtitle">é€‰æ‹©ç•Œé¢æ˜¾ç¤ºè¯­è¨€</text>
    </view>
    <view class="language-options">
      <view 
        class="language-item {{currentLanguage === 'zh' ? 'selected' : ''}}" 
        bindtap="onLanguageTap"
        data-language="zh"
      >
        <view class="language-info">
          <text class="language-name">{{t('settings.chinese')}}</text>
          <text class="language-desc">ç®€ä½“ä¸­æ–‡</text>
        </view>
        <text class="language-radio">{{currentLanguage === 'zh' ? 'â—' : 'â—‹'}}</text>
      </view>
      <view 
        class="language-item {{currentLanguage === 'en' ? 'selected' : ''}}" 
        bindtap="onLanguageTap"
        data-language="en"
      >
        <view class="language-info">
          <text class="language-name">{{t('settings.english')}}</text>
          <text class="language-desc">English</text>
        </view>
        <text class="language-radio">{{currentLanguage === 'en' ? 'â—' : 'â—‹'}}</text>
      </view>
    </view>
  </view>

  <!-- èœç³»åå¥½ -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">{{t('settings.favoriteCuisines')}}</text>
      <text class="section-subtitle">é€‰æ‹©ä½ åçˆ±çš„èœç³»ç±»å‹</text>
    </view>
    <view class="cuisine-grid">
      <view 
        class="cuisine-item {{preferences.favoriteCuisines.includes(item.id) ? 'selected' : ''}}" 
        wx:for="{{cuisineOptions}}" 
        wx:key="id"
        bindtap="onCuisineTap"
        data-cuisine="{{item.id}}"
      >
        <text class="cuisine-icon">{{item.icon}}</text>
        <text class="cuisine-name">{{item.name}}</text>
        <text class="cuisine-check">{{preferences.favoriteCuisines.includes(item.id) ? 'âœ“' : ''}}</text>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œéš¾åº¦ -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">{{t('settings.difficultyLevel')}}</text>
      <text class="section-subtitle">é€‰æ‹©ä½ èƒ½æ¥å—çš„åˆ¶ä½œéš¾åº¦</text>
    </view>
    <view class="difficulty-options">
      <view 
        class="difficulty-item {{preferences.difficultyLevel === item.id ? 'selected' : ''}}" 
        wx:for="{{difficultyOptions}}" 
        wx:key="id"
        bindtap="onDifficultyTap"
        data-difficulty="{{item.id}}"
      >
        <view class="difficulty-info">
          <text class="difficulty-name">{{item.name}}</text>
          <text class="difficulty-desc">{{item.description}}</text>
        </view>
        <text class="difficulty-radio">{{preferences.difficultyLevel === item.id ? 'â—' : 'â—‹'}}</text>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œæ—¶é—´ -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">åˆ¶ä½œæ—¶é—´</text>
      <text class="section-subtitle">æœ€å¤šæ„¿æ„èŠ±è´¹çš„åˆ¶ä½œæ—¶é—´ï¼š{{preferences.maxCookingTime}}åˆ†é’Ÿ</text>
    </view>
    <view class="time-slider">
      <slider 
        class="slider" 
        min="15" 
        max="120" 
        step="15" 
        value="{{preferences.maxCookingTime}}" 
        bindchange="onTimeChange"
        activeColor="#FF6B35"
        backgroundColor="#E5E5E5"
        block-size="24"
        block-color="#FF6B35"
      />
      <view class="time-labels">
        <text class="time-label">15åˆ†é’Ÿ</text>
        <text class="time-label">120åˆ†é’Ÿ</text>
      </view>
    </view>
  </view>

  <!-- å¿Œå£é£Ÿæ -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">å¿Œå£é£Ÿæ</text>
      <text class="section-subtitle">é€‰æ‹©ä½ ä¸å–œæ¬¢æˆ–è¿‡æ•çš„é£Ÿæ</text>
    </view>
    <view class="ingredient-tags">
      <text 
        class="ingredient-tag {{preferences.dislikedIngredients.includes(item) ? 'selected' : ''}}" 
        wx:for="{{ingredientOptions}}" 
        wx:key="*this"
        bindtap="onIngredientTap"
        data-ingredient="{{item}}"
      >
        {{item}}
      </text>
    </view>
  </view>

  <!-- é¥®é£Ÿåå¥½ -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">é¥®é£Ÿåå¥½</text>
      <text class="section-subtitle">ç‰¹æ®Šçš„é¥®é£Ÿéœ€æ±‚</text>
    </view>
    <view class="diet-options">
      <view class="diet-item" bindtap="onVegetarianToggle">
        <view class="diet-info">
          <text class="diet-name">ç´ é£Ÿä¸»ä¹‰</text>
          <text class="diet-desc">åªæ¨èç´ é£Ÿèœå“</text>
        </view>
        <switch 
          class="diet-switch" 
          checked="{{preferences.vegetarianOnly}}" 
          bindchange="onVegetarianToggle"
          color="#FF6B35"
        />
      </view>
    </view>
  </view>

  <!-- æ¨èè®¾ç½® -->
  <view class="setting-section">
    <view class="section-header">
      <text class="section-title">æ¨èè®¾ç½®</text>
      <text class="section-subtitle">ä¸ªæ€§åŒ–æ¨èç›¸å…³è®¾ç½®</text>
    </view>
    <view class="recommend-options">
      <view class="recommend-item" bindtap="onSmartRecommendToggle">
        <view class="recommend-info">
          <text class="recommend-name">æ™ºèƒ½æ¨è</text>
          <text class="recommend-desc">åŸºäºæµè§ˆå†å²ä¼˜åŒ–æ¨è</text>
        </view>
        <switch 
          class="recommend-switch" 
          checked="{{preferences.smartRecommend}}" 
          bindchange="onSmartRecommendToggle"
          color="#FF6B35"
        />
      </view>
      <view class="recommend-item" bindtap="onSeasonalToggle">
        <view class="recommend-info">
          <text class="recommend-name">æ—¶ä»¤æ¨è</text>
          <text class="recommend-desc">ä¼˜å…ˆæ¨èå½“å­£èœå“</text>
        </view>
        <switch 
          class="recommend-switch" 
          checked="{{preferences.seasonalRecommend}}" 
          bindchange="onSeasonalToggle"
          color="#FF6B35"
        />
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="action-btn action-btn-secondary" bindtap="onResetSettings">æ¢å¤é»˜è®¤</button>
    <button class="action-btn action-btn-primary" bindtap="onSaveSettings">ä¿å­˜è®¾ç½®</button>
  </view>

  <!-- è®¾ç½®è¯´æ˜ -->
  <view class="tips-section">
    <view class="tip-item">
      <text class="tip-icon">ğŸ’¡</text>
      <text class="tip-text">è®¾ç½®åå¥½åï¼Œç³»ç»Ÿä¼šä¸ºä½ æ¨èæ›´ç¬¦åˆå£å‘³çš„èœå“</text>
    </view>
    <view class="tip-item">
      <text class="tip-icon">ğŸ”„</text>
      <text class="tip-text">åå¥½è®¾ç½®ä¼šå®æ—¶ç”Ÿæ•ˆï¼Œéšæ—¶å¯ä»¥ä¿®æ”¹</text>
    </view>
    <view class="tip-item">
      <text class="tip-icon">ğŸ“Š</text>
      <text class="tip-text">ç³»ç»Ÿä¼šå­¦ä¹ ä½ çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œä¸æ–­ä¼˜åŒ–æ¨èæ•ˆæœ</text>
    </view>
  </view>
</view>

<!-- é‡ç½®ç¡®è®¤å¼¹çª— -->
<view class="modal-overlay {{showResetModal ? 'show' : ''}}" bindtap="onCloseResetModal">
  <view class="reset-modal" catchtap="stopPropagation">
    <view class="reset-header">
      <text class="reset-title">æ¢å¤é»˜è®¤è®¾ç½®</text>
    </view>
    <view class="reset-content">
      <text class="reset-text">ç¡®å®šè¦æ¢å¤æ‰€æœ‰è®¾ç½®åˆ°é»˜è®¤çŠ¶æ€å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</text>
    </view>
    <view class="reset-actions">
      <button class="reset-btn-secondary" bindtap="onCloseResetModal">å–æ¶ˆ</button>
      <button class="reset-btn-primary" bindtap="onConfirmReset">ç¡®å®šæ¢å¤</button>
    </view>
  </view>
</view>