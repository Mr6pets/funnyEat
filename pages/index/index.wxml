<!--pages/index/index.wxml-->
<view class="index-container">
  <!-- é¡¶éƒ¨é—®å€™è¯­ -->
  <view class="greeting-section">
    <view class="greeting-text">
      <text class="greeting-main">ä»Šå¤©åƒä»€ä¹ˆï¼Ÿ</text>
      <text class="greeting-sub">è®©æˆ‘æ¥å¸®ä½ å†³å®šå§ ğŸ½ï¸</text>
    </view>
  </view>

  <!-- ä»Šæ—¥æ¨è -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥æ¨è</text>
      <text class="section-subtitle">ä¸ºä½ ç²¾å¿ƒæŒ‘é€‰</text>
    </view>
    <scroll-view class="recommendation-scroll" scroll-x="true" show-scrollbar="false">
      <view class="recommendation-list">
        <view 
          class="recommendation-card" 
          wx:for="{{todayRecommendations}}" 
          wx:key="id"
          bindtap="onRecommendationTap"
          data-dish="{{item}}"
        >
          <image class="recommendation-image" src="{{item.dish.imageUrl}}" mode="aspectFill" />
          <view class="recommendation-overlay">
            <view class="recommendation-tag">{{item.tag}}</view>
            <view class="recommendation-info">
              <text class="recommendation-name">{{item.dish.name}}</text>
              <text class="recommendation-reason">{{item.reason}}</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- å¿«é€Ÿé€‰æ‹© -->
  <view class="section">
    <view class="quick-choice-container">
      <view class="quick-choice-content">
        <text class="quick-choice-title">ä¸çŸ¥é“åƒä»€ä¹ˆï¼Ÿ</text>
        <text class="quick-choice-subtitle">æ‘‡ä¸€æ‘‡ï¼Œè®©è¿æ°”æ¥å†³å®š</text>
        <button 
          class="quick-choice-btn {{isShaking ? 'shaking' : ''}}" 
          bindtap="onQuickChoice"
          disabled="{{isShaking}}"
        >
          <text class="quick-choice-icon">ğŸ²</text>
          <text class="quick-choice-text">{{isShaking ? 'æ­£åœ¨é€‰æ‹©...' : 'æ‘‡ä¸€æ‘‡'}}</text>
        </button>
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»æµè§ˆ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">åˆ†ç±»æµè§ˆ</text>
      <text class="section-subtitle">æŒ‰ç±»å‹é€‰æ‹©</text>
    </view>
    <view class="category-grid">
      <view 
        class="category-item" 
        wx:for="{{categories}}" 
        wx:key="id"
        bindtap="onCategoryTap"
        data-category="{{item}}"
        data-category-id="{{item.id}}"
        data-category-name="{{item.name}}"
      >
        <view class="category-icon-wrapper" style="background-color: {{item.color}}20;">
          <text class="category-icon">{{item.icon}}</text>
        </view>
        <text class="category-name">{{item.name}} ({{item.id}})</text>
      </view>
    </view>
  </view>

  <!-- èœç³»æ¨è -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨èœç³»</text>
      <text class="section-subtitle">åœ°æ–¹ç‰¹è‰²</text>
    </view>
    <view class="cuisine-list">
      <view 
        class="cuisine-item" 
        wx:for="{{cuisines}}" 
        wx:key="id"
        bindtap="onCuisineTap"
        data-cuisine="{{item}}"
      >
        <text class="cuisine-icon">{{item.icon}}</text>
        <view class="cuisine-info">
          <text class="cuisine-name">{{item.name}}</text>
          <text class="cuisine-desc">{{item.description}}</text>
        </view>
        <text class="cuisine-arrow">â€º</text>
      </view>
    </view>
  </view>
</view>

<!-- å¿«é€Ÿé€‰æ‹©ç»“æœå¼¹çª— -->
<view class="modal-overlay {{showResult ? 'show' : ''}}" bindtap="onCloseResult">
  <view class="result-modal" catchtap="stopPropagation">
    <view class="result-header">
      <text class="result-title">ä»Šå¤©å°±åƒè¿™ä¸ªå§ï¼</text>
      <text class="result-close" bindtap="onCloseResult">Ã—</text>
    </view>
    <view class="result-content" wx:if="{{selectedDish}}">
      <image class="result-image" src="{{selectedDish.imageUrl}}" mode="aspectFill" />
      <view class="result-info">
        <text class="result-dish-name">{{selectedDish.name}}</text>
        <text class="result-dish-desc">{{selectedDish.description}}</text>
        <view class="result-tags">
          <text class="result-tag" wx:for="{{selectedDish.tags}}" wx:key="*this">{{item}}</text>
        </view>
        <view class="result-meta">
          <text class="result-meta-item">â±ï¸ {{selectedDish.cookingTime}}åˆ†é’Ÿ</text>
          <text class="result-meta-item">ğŸ”¥ {{selectedDish.calories}}å¡</text>
          <text class="result-meta-item">â­ {{selectedDish.rating}}</text>
        </view>
      </view>
    </view>
    <view class="result-actions">
      <button class="result-btn result-btn-secondary" bindtap="onQuickChoice">å†æ‘‡ä¸€æ¬¡</button>
      <button class="result-btn result-btn-primary" bindtap="onViewDetail">æŸ¥çœ‹è¯¦æƒ…</button>
    </view>
  </view>
</view>